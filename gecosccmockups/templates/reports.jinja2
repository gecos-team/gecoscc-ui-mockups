{% extends "base_navbar.jinja2" %}

{% block nav_bar_home %}{% endblock %}
{% block nav_bar_reports %}active{% endblock %}

{% block extraheader %}
<style>
    div.container {
        margin-bottom: 25px;
    }

    ul.report li {
        margin-bottom: 10px;
    }

    #failed ul li .type-icon,
    #pending ul li .type-icon {
        margin: 0 10px;
    }

    #failed ul li .label,
    #pending ul li .label {
        position: relative;
        top: 1px;
        margin-left: 5px;
    }
</style>
{% endblock %}

{% block inner_content %}
<div class="container">
    <div class="row"><div class="col-sm-12">
        <h1>Informes</h1>
    </div></div>
    <div class="row"><div class="col-sm-12">
        <ul class="nav nav-tabs">
            <li class="active"><a href="#failed" data-toggle="tab">Tareas fallidas</a></li>
            <li><a href="#pending" data-toggle="tab">Tareas pendientes</a></li>
            <li><a href="#users" data-toggle="tab">Usuarios existentes</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane fade in active" id="failed">
                <p class="mb20">Filtrar por Unidad Organizativa: <a href="#"><span class="label label-default">Sede Central</span></a> <a href="#"><span class="label label-default">Sede Exterior</span></a></p>
                <ul class="report">
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 10 - Sede Central, alta de un nuevo puesto de trabajo <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 15 - Sede Exterior, mauris mauris, lacinia eget tortor <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">4/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 16 - Sede Central, bibendum vulputate turpis <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 32 - Sede Central, ulputate quis, convallis eget nunc <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 45 - Sede Central, ut porttitor felis, et adipiscing eros <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 78 - Sede Central, vel orci pellentesque sapien condimentum <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 81 - Sede Exterior, bibendum tortor sed metus <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">3/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 82 - Sede Exterior, vulputate ultricies <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 83 - Sede Exterior, pulvinar quis laoreet sit amet <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">3/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 103 - Sede Central, dictum felis eget lacus lobortis <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 112 - Sede Central, non sem tristique, euismod ante adipiscing <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 167 - Sede Exterior, et dui eu neque vehicula euismod <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 201 - Sede Exterior, aermentum auctor accumsano <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">4/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 204 - Sede Central, vel nibh vitae lacus bibendum ultricies <span class="label label-danger pull-right">Fallida</span><span class="badge pull-right">3/4</span></li>
                </ul>
                <button class="btn btn-default pull-right">Exportar a CSV</button>
            </div>

            <div class="tab-pane fade" id="pending">
                <p class="mb20">Filtrar por Unidad Organizativa: <a href="#"><span class="label label-success">Sede Central</span></a> <a href="#"><span class="label label-default">Sede Exterior</span></a></p>
                <ul class="report">
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 10 - Sede Central, alta de un nuevo puesto de trabajo <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 15 - Sede Central, mauris mauris, lacinia eget tortor <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 16 - Sede Central, bibendum vulputate turpis <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 83 - Sede Central, pulvinar quis laoreet sit amet <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">3/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 103 - Sede Central, dictum felis eget lacus lobortis <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">3/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 112 - Sede Central, non sem tristique, euismod ante adipiscing <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 167 - Sede Central, et dui eu neque vehicula euismod <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">1/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 201 - Sede Central, aermentum auctor accumsano <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">2/4</span></li>
                    <li><button class="btn-modal btn btn-info btn-xs"><span class="fa fa-info"></span> Info</button> <span class="fa fa-desktop type-icon"></span> Cambio 204 - Sede Central, vel nibh vitae lacus bibendum ultricies <span class="label label-warning pull-right">Pendiente</span><span class="badge pull-right">3/4</span></li>
                </ul>
                <button class="btn btn-default pull-right">Exportar a CSV</button>
            </div>

            <div class="tab-pane fade" id="users">
                <div class="row mb10"><div class="col-xs-12 col-sm-9 col-md-6">
                    <div class="input-group">
                        <input type="text" class="form-control" id="user-filter" placeholder="Filtra">
                        <span class="input-group-btn">
                            <button class="btn btn-primary" id="user-filter-btn" type="button"><span class="fa fa-search"></span></button>
                        </span>
                    </div>
                </div></div>
                <div class="row"><div class="col-xs-12 col-sm-12">
                    <ul class="report">
                        <li><a href="/users/"><span class="fa fa-user"></span> Juan Nadie (juannadie)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Aenean Hendrerit (hendrerit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Lorem Ipsum (ipsum)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Quisque Luctus (qluctus)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Maecenas Id (maecenasid)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Cras Convallis (convallis)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Etiam Sit (etiamsit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Vestibulum Ante (vestibulumante)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Donec Vehicula (dvehicula)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Aenean Hendrerit (hendrerit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Lorem Ipsum (ipsum)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Quisque Luctus (qluctus)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Maecenas Id (maecenasid)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Cras Convallis (convallis)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Etiam Sit (etiamsit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Vestibulum Ante (vestibulumante)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Donec Vehicula (dvehicula)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Aenean Hendrerit (hendrerit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Lorem Ipsum (ipsum)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Quisque Luctus (qluctus)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Maecenas Id (maecenasid)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Cras Convallis (convallis)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Etiam Sit (etiamsit)</a> - Sede Central</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Vestibulum Ante (vestibulumante)</a> - Sede Exterior</li>
                        <li><a href="/users/"><span class="fa fa-user"></span> Donec Vehicula (dvehicula)</a> - Sede Exterior</li>
                    </ul>
                </div></div>
            </div>
        </div>
    </div></div>

    <div id="task-modal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Cambio 16 - Sede Central, política, cambio del tema de iconos</h4>
                </div>
                <div class="modal-body">
                    <p class="pull-right">Progreso: <span class="label label-danger">3 de 5</span></p>
                    <label>Equipos</label>
                    <ol>
                        <li>Portátil de Juan [juan-laptop]</li>
                        <li>Portátil de Roberto [bob-laptop]</li>
                        <li>Portátil de Anabel [anabel-laptop]</li>
                        <li>Sobremesa del Departamento de Cuentas [cuentas-desktop]</li>
                        <li>Portátil de Lola [lola-laptop]</li>
                    </ol>

                    <label>Logs</label>
                    <ul class="list-unstyled">
                        <li>09:12 Comenzado preparativos</li>
                        <li>09:12 Copiando fichero en almacenamiento compartido</li>
                        <li><span class="text-success">09:13 Terminados los preparativos</span></li>
                        <li>09:13 Comenzando a aplicar cambios</li>
                        <li><span class="text-success">09:14 Cambio aplicado en juan-laptop</span></li>
                        <li><span class="text-success">09:14 Cambio aplicado en bob-laptop</span></li>
                        <li>
                            <a href="#" class="expand-log"><span class="text-danger"><span class="fa fa-caret-right"></span> 09:14 Error al aplicar cambio en anabel-laptop</span></a>
                            <textarea class="hide form-control" rows="8" disabled>
[  102.713692] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SBRG.EC0_.STBR] (Node ffff880139e936f0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.713704] ACPI Error: Method parse/execution failed [\_SB_.PCI0.VGA_.LCDD._BCM] (Node ffff880139e8ace0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.713716] ACPI Error: Evaluating _BCM failed (20120913/video-364)
[  102.715864] ACPI Exception: AE_AML_BUFFER_LIMIT, Index (0x0000000000000064) is beyond end of object (20120913/exoparg2-418)
[  102.715875] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SBRG.EC0_.STBR] (Node ffff880139e936f0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.715886] ACPI Error: Method parse/execution failed [\_SB_.PCI0.VGA_.LCDD._BCM] (Node ffff880139e8ace0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.715898] ACPI Error: Evaluating _BCM failed (20120913/video-364)
[  102.717600] ACPI Exception: AE_AML_BUFFER_LIMIT, Index (0x0000000000000064) is beyond end of object (20120913/exoparg2-418)
[  102.717610] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SBRG.EC0_.STBR] (Node ffff880139e936f0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.717621] ACPI Error: Method parse/execution failed [\_SB_.PCI0.VGA_.LCDD._BCM] (Node ffff880139e8ace0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.717633] ACPI Error: Evaluating _BCM failed (20120913/video-364)
[  102.894493] ACPI Exception: AE_AML_BUFFER_LIMIT, Index (0x0000000000000064) is beyond end of object (20120913/exoparg2-418)
[  102.894506] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SBRG.EC0_.STBR] (Node ffff880139e936f0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.894517] ACPI Error: Method parse/execution failed [\_SB_.PCI0.VGA_.LCDD._BCM] (Node ffff880139e8ace0), AE_AML_BUFFER_LIMIT (20120913/psparse-536)
[  102.894529] ACPI Error: Evaluating _BCM failed (20120913/video-364)
                            </textarea>
                        </li>
                        <li>
                            <a href="#" class="expand-log"><span class="text-danger"><span class="fa fa-caret-right"></span> 09:14 Error: file does not exist</span></a>
                            <textarea class="hide form-control" rows="8" disabled>
[   17.318853] type=1400 audit(1385017506.642:2): apparmor="STATUS" operation="profile_load" name="/{usr/,}bin/ping" pid=566 comm="apparmor_parser"
[   17.336115] type=1400 audit(1385017506.660:3): apparmor="STATUS" operation="profile_load" name="/sbin/klogd" pid=575 comm="apparmor_parser"
[   17.345527] type=1400 audit(1385017506.669:4): apparmor="STATUS" operation="profile_load" name="/sbin/syslog-ng" pid=579 comm="apparmor_parser"
[   17.355109] type=1400 audit(1385017506.679:5): apparmor="STATUS" operation="profile_load" name="/sbin/syslogd" pid=583 comm="apparmor_parser"
[   17.369211] type=1400 audit(1385017506.693:6): apparmor="STATUS" operation="profile_load" name="/usr/lib/apache2/mpm-prefork/apache2" pid=588 comm="apparmor_parser"
[   17.369787] type=1400 audit(1385017506.693:7): apparmor="STATUS" operation="profile_load" name="/usr/lib/apache2/mpm-prefork/apache2//DEFAULT_URI" pid=588 comm="apparmor_parser"
[   17.370338] type=1400 audit(1385017506.694:8): apparmor="STATUS" operation="profile_load" name="/usr/lib/apache2/mpm-prefork/apache2//HANDLING_UNTRUSTED_INPUT" pid=588 comm="apparmor_parser"
[   17.370827] type=1400 audit(1385017506.694:9): apparmor="STATUS" operation="profile_load" name="/usr/lib/apache2/mpm-prefork/apache2//phpsysinfo" pid=588 comm="apparmor_parser"
[   17.380573] type=1400 audit(1385017506.704:10): apparmor="STATUS" operation="profile_load" name="/usr/lib/dovecot/deliver" pid=592 comm="apparmor_parser"
[   17.390493] type=1400 audit(1385017506.714:11): apparmor="STATUS" operation="profile_load" name="/usr/lib/dovecot/dovecot-auth" pid=596 comm="apparmor_parser"
                           </textarea>
                        </li>
                        <li>
                            <a href="#" class="expand-log"><span class="text-danger"><span class="fa fa-caret-right"></span> 09:14 Abortando</span></a>
                            <textarea class="hide form-control" rows="8" disabled>
[   32.575784] cgroup: libvirtd (837) created nested cgroup for controller "memory" which has incomplete hierarchy support. Nested cgroups may change behavior in the future.
[   32.575790] cgroup: "memory" requires setting use_hierarchy to 1 on the root.
                            </textarea>
                        </li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</div>
{% endblock %}

{% block extrajs %}
<script>
    $(document).ready(function () {
        var modal = $("#task-modal").modal({ show: false });
        $("button.btn-modal").click(function (evt) {
            evt.preventDefault();
            modal.modal("show");
        });

        var filter = function (filter, $elements) {
            var filter = filter.toLowerCase();
            $elements.removeClass("hide");
            $elements.each(function (idx, el) {
                var $el = $(el);
                if ($el.text().toLowerCase().indexOf(filter) < 0) {
                    $el.addClass("hide");
                }
            });
        };
        $("#user-filter").on("keyup", function (evt) {
            var $input = $(evt.target),
                $elements = $input.parents("#users").find("li");
            filter($input.val(), $elements);
        });
        $("#user-filter-btn").click(function (evt) {
            evt.preventDefault();
            var $input = $(evt.target).parents("div.input-group").find("#user-filter"),
                $elements = $input.parents("#users").find("li");
            filter($input.val(), $elements);
        });

        $("#task-modal a.expand-log").click(function (evt) {
            evt.preventDefault();
            var $li = $(evt.target).parents("li"),
                hidden = $li.find("textarea").is(".hide");

            $li.find("span.fa")
                .removeClass(hidden ? "fa-caret-right" : "fa-caret-down")
                .addClass(hidden ? "fa-caret-down" : "fa-caret-right");
            $li.find("textarea").toggleClass("hide");
        });
    });
</script>
{% endblock %}
